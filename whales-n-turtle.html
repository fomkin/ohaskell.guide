<!DOCTYPE HTML>

<html lang="ru">
    <head>
        <meta charset="utf-8">
        <meta name="description" content="О Haskell по-человечески. Ваша первая книга о прекрасном и удивительном языке программирования.">
        <meta name="author" content="Денис Шевченко">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0">
        <title>
            Киты и Черепаха &lt;- О Haskell по-человечески
        </title>
        <link rel="icon" href="./static/images/favicon.ico">
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js">
            
        </script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.5/css/materialize.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.5/js/materialize.min.js">
            
        </script>
        <link rel="stylesheet" href="./static/css/default.css">
        <script src="./static/js/default.js">
            
        </script>
    </head>
    <body>
        <div class="navbar-fixed">
            <nav>
                <div class="nav-wrapper">
                    <a class="brand-logo center sans" href="./">
                        #ohaskell
                        <span style="font-size: 19px; color: yellow;">
                            &beta;
                        </span>
                    </a>
                    <ul id="nav-mobile" class="left">
                        <li>
                            <a href="#" data-activates="mobile-demo" class="button-collapse show-on-large">
                                <span class="fa fa-list-ul" style="font-size: 26px;">
                                    
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="./subject-index.html">
                                <span class="fa fa-tags" style="font-size: 22px;">
                                    
                                </span>
                            </a>
                        </li>
                    </ul>
                    <ul class="side-nav sans" id="mobile-demo">
                        <li>
                            <a href="./init.html">
                                Приветствую!
                            </a>
                        </li>
                        <li>
                            <a href="./haskell-faq.html">
                                Первые вопросы
                            </a>
                        </li>
                        <li>
                            <a href="./this-book.html">
                                Об этой книге
                            </a>
                        </li>
                        <li>
                            <a href="./setup.html">
                                Приготовимся
                            </a>
                        </li>
                        <li>
                            <a href="./whales-n-turtle.html">
                                Киты и Черепаха
                            </a>
                        </li>
                        <li>
                            <a href="./immutability-n-purity.html">
                                Неизменность и чистота
                            </a>
                        </li>
                        <li>
                            <a href="./if-n-return.html">
                                Выбираем и возвращаемся
                            </a>
                        </li>
                        <li>
                            <a href="./choose-n-patterns.html">
                                Выбор и образцы
                            </a>
                        </li>
                        <li>
                            <a href="./let-n-where.html">
                                Пусть будет там, Где...
                            </a>
                        </li>
                        <li>
                            <a href="./operators.html">
                                Мир операторов
                            </a>
                        </li>
                        <li>
                            <a href="./list.html">
                                Список
                            </a>
                        </li>
                        <li>
                            <a href="./tuple.html">
                                Кортеж
                            </a>
                        </li>
                        <li>
                            <a href="./lambda-function.html">
                                Лямбда-функция
                            </a>
                        </li>
                        <li>
                            <a href="./function-composition.html">
                                Композиция функций
                            </a>
                        </li>
                        <li>
                            <a href="./hof.html">
                                ФВП
                            </a>
                        </li>
                        <li>
                            <a href="./hackage.html">
                                Hackage и библиотеки
                            </a>
                        </li>
                        <li>
                            <a href="./recursion.html">
                                Рекурсия
                            </a>
                        </li>
                        <li>
                            <a href="./laziness.html">
                                Лень
                            </a>
                        </li>
                        <li>
                            <a href="./own-types.html">
                                Наши типы
                            </a>
                        </li>
                        <li>
                            <a href="./adt.html">
                                АТД
                            </a>
                        </li>
                        <li>
                            <a href="./adt-field-labels.html">
                                АТД: поля с метками
                            </a>
                        </li>
                        <li>
                            <a href="./work-in-progress.html">
                                Продолжение следует...
                            </a>
                        </li>
                    </ul>
                    <ul id="nav-mobile" class="right">
                        <li>
                            <a href="https://github.com/denisshevchenko/ohaskell.guide" target="_blank">
                                <span class="fa fa-github">
                                    
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="mailto:me@dshevchenko.biz?Subject=#ohaskell,%20О%20книге" title="Написать автору">
                                <span class="fa fa-envelope-o">
                                    
                                </span>
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>
        </div>
        <div class="container">
            <h1 id="киты-и-черепаха">Киты и Черепаха</h1>
<p>Итак, проект создали, теперь мы готовы начать наше путешествие.</p>
<p>Haskell стоит на Трёх Китах, имена которым: <strong>Функция</strong>, <strong>Тип</strong> и <strong>Класс типов</strong>. Они же, в свою очередь, покоятся на огромной Черепахе, имя которой — <strong>Выражение</strong>.</p>
<h2 id="черепаха">Черепаха</h2>
<p>Haskell-программа представляет собой совокупность выражений (англ. expression). Взгляните:</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="dv">1</span> <span class="fu">+</span> <span class="dv">2</span></code></pre></div>
<p>Это — основной кирпич Haskell-программы, будь то Hello World или часть инфраструктуры международного банка. Конечно, помимо сложения единицы с двойкой существуют и другие выражения, но суть у них у всех одна:</p>
<blockquote>
<p>Выражение — это то, что может дать нам некий полезный результат.</p>
</blockquote>
<p>Полезный результат мы получаем в результате вычисления (англ. evaluation) выражения. Все выражения можно вычислить, однако одни выражения в результате вычисления уменьшаются (англ. reduce), а другие — нет. Первые иногда называют редуцируемыми выражениями, а вторые — нередуцируемые. Так, выражение:</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="dv">1</span> <span class="fu">+</span> <span class="dv">2</span></code></pre></div>
<p>относится к редуцируемым, потому что оно в результате вычисления уменьшится и даст нам другое выражение:</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="dv">3</span></code></pre></div>
<p>Это выражение уже нельзя уменьшить, оно нередуцируемое и мы теперь лишь можем использовать его как есть.</p>
<p>Таким образом, выражения, составляющие программу, вычисляются/редуцируются до тех пор, пока не останется некое окончательное, корневое выражение. А запуск Haskell-программы на выполнение (англ. execution) — это запуск всей этой цепочки вычислений, причём с корнем этой цепочки мы уже познакомились ранее. Помните функцию <code>main</code>, определённую в модуле <code>app/Main.hs</code>? Вот эта функция и является главной точкой нашей программы, её Альфой и Омегой.</p>
<h2 id="первый-кит">Первый Кит</h2>
<p>Вернёмся к выражению <code>1 + 2</code>. Полезный результат мы получим лишь после того, как вычислим это выражение, то есть осуществим сложение. И как же можно «осуществить сложение» в рамках Haskell-программы? С помощью функции. Именно функция делает выражение вычислимым, именно она оживляет нашу программу, потому я и назвал Функцию Первым Китом Haskell. Но дабы избежать недоразумений, определимся с понятиями.</p>
<p>Что такое функция в математике? Вспомним школьный курс:</p>
<blockquote>
<p>Функция — это закон, описывающий зависимость одного значения от другого.</p>
</blockquote>
<p>Рассмотрим функцию возведения целого числа в квадрат:</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell">square v <span class="fu">=</span> v <span class="fu">*</span> v</code></pre></div>
<p>Функция <code>square</code> определяет простую зависимость: числу <code>2</code> соответствует число <code>4</code>, числу <code>3</code> — <code>9</code>, и так далее. Схематично это можно записать так:</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="dv">2</span> <span class="ot">-&gt;</span> <span class="dv">4</span>
<span class="dv">3</span> <span class="ot">-&gt;</span> <span class="dv">9</span>
<span class="dv">4</span> <span class="ot">-&gt;</span> <span class="dv">16</span>
<span class="dv">5</span> <span class="ot">-&gt;</span> <span class="dv">25</span>
<span class="fu">...</span></code></pre></div>
<p>Входное значение функции называют аргументом. А так как функция определяет однозначную зависимость выходного значения от аргумента, её, функцию, называют ещё <em>отображением</em>: она отображает/проецирует входное значение на выходное. Получается как бы труба: кинули в неё <code>2</code> — с другой стороны вылетело <code>4</code>, кинули <code>5</code> — вылетело <code>25</code>.</p>
<p>Чтобы заставить функцию сделать полезную работу, её необходимо применить (англ. apply) к аргументу. Пример:</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell">square <span class="dv">2</span></code></pre></div>
<p>Мы применили функцию <code>square</code> к аргументу <code>2</code>. Синтаксис предельно прост: имя функции и через пробел аргумент. Если аргументов более одного — просто дописываем их так же, через пробел. Например, функция <code>sum</code>, вычисляющая сумму двух своих целочисленных аргументов, применяется так:</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell">sum <span class="dv">10</span> <span class="dv">20</span></code></pre></div>
<p>Так вот выражение <code>1 + 2</code> есть ни что иное, как применение функции! И чтобы яснее это увидеть, перепишем выражение:</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell">(<span class="fu">+</span>) <span class="dv">1</span> <span class="dv">2</span></code></pre></div>
<p>Это применение функции <code>(+)</code> к двум аргументам, <code>1</code> и <code>2</code>. Не удивляйтесь, что имя функции заключено в скобки, вскоре я расскажу об этом подробнее. А пока запомните главное:</p>
<blockquote>
<p>Вычислить выражение — это значит применить какие-то функции (одну или более) к каким-то аргументам (одному или более).</p>
</blockquote>
<p>И ещё. Возможно, вы слышали о так называемом «вызове» функции. В Haskell функции не вызывают. Понятие «вызов» функции пришло к нам из почтенного языка C. Там функции действительно вызывают (англ. call), потому что в C, в отличие от Haskell, понятие «функция» не имеет никакого отношения к математике. Там это подпрограмма, то есть обособленный кусочек программы, доступный по некоторому адресу в памяти. Если у вас есть опыт разработки на C-подобных языках — забудьте о подпрограмме. В Haskell функция — это функция в математическом смысле слова, поэтому её не вызывают, а применяют к чему-то.</p>
<h2 id="второй-кит">Второй Кит</h2>
<p>Итак, любое редуцируемое выражение суть применение функции к некоторому аргументу (тоже являющемуся выражением):</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell">square   <span class="dv">2</span>
функция  аргумент</code></pre></div>
<p>Аргумент представляет собой некоторое значение, его ещё называют «данное» (англ. data). Данные в Haskell — это сущности, обладающие двумя главными характеристиками: типом и конкретным значением/содержимым.</p>
<p>Тип — это Второй Кит в Haskell. Тип отражает конкретное содержимое данных, а потому все данные в программе обязательно имеют некий тип. Когда мы видим данное типа <code>Double</code>, мы точно знаем, что перед нами число с плавающей точкой, а когда видим данные типа <code>String</code> — можем ручаться, что перед нами строки.</p>
<p>Отношение к типам в Haskell очень серьёзное, и работа с типами характеризуется тремя важными чертами:</p>
<ol style="list-style-type: decimal">
<li>статическая проверка,</li>
<li>сила,</li>
<li>выведение.</li>
</ol>
<p>Три эти свойства системы типов Haskell — наши добрые друзья, ведь они делают нашу программистскую жизнь счастливее. Познакомимся с ними.</p>
<h3 id="статическая-проверка">Статическая проверка</h3>
<p>Статическая проверка типов (англ. static type checking) — это проверка типов всех данных в программе, осуществляемая на этапе компиляции. Haskell-компилятор упрям: когда ему что-либо не нравится в типах, он громко ругается. Поэтому если функция работает с целыми числами, применить её к строкам никак не получится. Так что если компиляция нашей программы завершилась успешно, мы точно знаем, что с типами у нас всё в порядке. Преимущества статической проверки невозможно переоценить, ведь она гарантирует отсутствие в наших программах целого ряда ошибок. Мы уже не сможем спутать числа со строками или вычесть метры из рублей.</p>
<p>Конечно, у этой медали есть и обратная сторона — время, затрачиваемое на компиляцию. Вам придётся свыкнуться с этой мыслью: внесли изменения в проект — будьте добры скомпилировать. Однако утешением вам пусть послужит тот факт, что преимущества статической проверки куда ценнее времени, потраченного на компиляцию.</p>
<h3 id="сила">Сила</h3>
<p>Сильная (англ. strong) система типов — это бескомпромиссный контроль соответствия ожидаемого действительному. Сила делает работу с типами ещё более аккуратной. Вот вам пример из мира C:</p>
<div class="sourceCode"><pre class="sourceCode c"><code class="sourceCode c"><span class="dt">double</span> coeff(<span class="dt">double</span> base) {
    <span class="kw">return</span> base * <span class="fl">4.9856</span>;
}

<span class="dt">int</span> main() {
    <span class="dt">int</span> value = coeff(<span class="fl">122.04</span>);
    ...
}</code></pre></div>
<p>Это канонический пример проблемы, обусловленной слабой (англ. weak) системой типов. Функция <code>coeff</code> возвращает значение типа <code>double</code>, однако вызывающая сторона ожидает почему-то целое число. Ну вот ошиблись мы, криво скопировали. В этом случае произойдёт жульничество, называемое скрытым приведением типов (англ. type casting): число с плавающей точкой, возвращённое функцией <code>coeff</code>, будет грубо сломано путём приведения его к типу <code>int</code>, в результате чего дробная часть будет отброшена и мы получим не <code>608.4426</code>, а <code>608</code>. Подобная ошибка, кстати, приводила к серьёзным последствиям, таким как уничтожение космических аппаратов. Нет, это вовсе не означает, что слабая типизация ужасна сама по себе, просто есть иной путь.</p>
<p>Благодаря сильной типизации в Haskell подобный код не имеет ни малейших шансов пройти компиляцию. Мы всегда получаем то, что ожидаем, и если должно быть число с плавающей точкой — расшибись, но предоставь именно его. Компилятор скрупулёзно отслеживает соответствие ожидаемого типа фактическому, поэтому когда компиляция завершается успешно, мы абсолютно уверены в гармонии между типами всех наших данных.</p>
<h3 id="выведение">Выведение</h3>
<p>Выведение (англ. inference) типов — это способность определить тип данных автоматически, по конкретному выражению. В том же языке C тип данных следует указывать явно:</p>
<div class="sourceCode"><pre class="sourceCode c"><code class="sourceCode c"><span class="dt">double</span> value = <span class="fl">122.04</span>;</code></pre></div>
<p>однако в Haskell мы напишем просто:</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell">value <span class="fu">=</span> <span class="fl">122.04</span></code></pre></div>
<p>В этом случае компилятор автоматически выведет тип <code>value</code> как <code>Double</code>.</p>
<p>Выведение типов делает наш код лаконичнее и проще в сопровождении. Впрочем, мы можем указать тип значения и явно, а иногда даже должны это сделать. В последующих главах я объясню, почему.</p>
<p>Да, кстати, вот простейшие стандартные типы, они нам понадобятся:</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="dv">123</span>         <span class="dt">Int</span>
<span class="fl">23.5798</span>     <span class="dt">Double</span>
<span class="ch">'a'</span>         <span class="dt">Char</span>
<span class="st">&quot;Hello!&quot;</span>    <span class="dt">String</span>
<span class="dt">True</span>        <span class="dt">Bool</span>, истина
<span class="dt">False</span>       <span class="dt">Bool</span>, ложь</code></pre></div>
<p>С типами <code>Int</code> и <code>Double</code> вы уже знакомы. Тип <code>Char</code> — это Unicode-символ. Тип <code>String</code> — строка, состоящая из Unicode-символов. Тип <code>Bool</code> — логический тип, соответствующий истине или лжи. В последующих главах мы встретимся ещё с несколькими стандартными типами, но пока хватит и этих. И заметьте: имя типа в Haskell всегда начинается с большой буквы.</p>
<h2 id="третий-кит">Третий Кит</h2>
<p>А вот о Третьем Ките, о <strong>Классе типов</strong>, я пока умолчу, потому что знакомиться с ним следует лишь после того, как мы поближе подружимся с первыми двумя.</p>
<p>Уверен, после прочтения этой главы у вас появилось множество вопросов. Ответы будут, но позже. Более того, следующая глава несомненно удивит вас.</p>
<h2 id="для-любопытных">Для любопытных</h2>
<p>Если вы работали с объектно-ориентированными языками, такими как C++, вас удивит тот факт, что в Haskell между понятиями «тип» и «класс» проведено чёткое различие. А поскольку типам и классам типов в Haskell отведена колоссально важная роль, добрый вам совет: когда в будущих главах мы познакомимся с ними поближе, не пытайтесь проводить аналогии из других языков. Например, некоторые усматривают родство между классами типов в Haskell и интерфейсами в Java. Не делайте этого, во избежание путаницы.</p>
<div style="padding-top: 45px;">
    
</div>
<div class="row">
    <div class="col s3">
        <div class="left">
            <a href="/setup.html" class="btn waves-effect waves-light chapter-arrow">
                <span class="fa fa-angle-double-left">
                    
                </span>
            </a>
        </div>
    </div>
    <div class="col s6">
        <div class="center-align">
            <button class="waves-effect waves-light btn blue lighten-2 show-comments sans">
                Обсудим?
            </button>
        </div>
    </div>
    <div class="col s3">
        <div class="right">
            <a href="/immutability-n-purity.html" class="btn waves-effect waves-light chapter-arrow">
                <span class="fa fa-angle-double-right">
                    
                </span>
            </a>
        </div>
    </div>
</div>
<div style="padding-top: 20px;">
    
</div>
<div id="disqus_thread" style="padding-top: 30px;">
    
</div>

        </div>
    </body>
</html>
